{
  "issue_id": 2394,
  "issue_url": "https://github.com/mockito/mockito/issues/2394",
  "title": "Regression with InOrder verification after #2369",
  "description": "<p dir=\"auto\">The following test starts failing after <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/mockito/mockito/commit/123beb8311ed6303ba71d682cff8434fe36b7f0f/hovercard\" href=\"https://github.com/mockito/mockito/commit/123beb8311ed6303ba71d682cff8434fe36b7f0f\"><tt>123beb8</tt></a>. It looks like the change to call actual <code class=\"notranslate\">equals</code> and <code class=\"notranslate\">hashCode</code> methods is catching a call to <code class=\"notranslate\">equals</code> inside the implementation of <code class=\"notranslate\">InOrder</code>.</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"package com.test;\n\nimport static org.mockito.Mockito.inOrder;\nimport static org.mockito.Mockito.spy;\n\nimport org.junit.Test;\nimport org.mockito.InOrder;\n\npublic class AppTest {\n\n  static class Foo {\n    void foo() {}\n  }\n\n  @Test\n  public void test() {\n    Foo mock1 = spy(new Foo());\n    Foo mock2 = spy(new Foo());\n    mock1.foo();\n    InOrder order = inOrder(mock1, mock2);\n    order.verify(mock1).foo();\n    order.verifyNoMoreInteractions();\n  }\n}\"><pre><span class=\"pl-k\">package</span> <span class=\"pl-s1\">com</span>.<span class=\"pl-s1\">test</span>;\n\n<span class=\"pl-k\">import</span> <span class=\"pl-k\">static</span> <span class=\"pl-s1\">org</span>.<span class=\"pl-s1\">mockito</span>.<span class=\"pl-s1\">Mockito</span>.<span class=\"pl-s1\">inOrder</span>;\n<span class=\"pl-k\">import</span> <span class=\"pl-k\">static</span> <span class=\"pl-s1\">org</span>.<span class=\"pl-s1\">mockito</span>.<span class=\"pl-s1\">Mockito</span>.<span class=\"pl-s1\">spy</span>;\n\n<span class=\"pl-k\">import</span> <span class=\"pl-s1\">org</span>.<span class=\"pl-s1\">junit</span>.<span class=\"pl-s1\">Test</span>;\n<span class=\"pl-k\">import</span> <span class=\"pl-s1\">org</span>.<span class=\"pl-s1\">mockito</span>.<span class=\"pl-s1\">InOrder</span>;\n\n<span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-smi\">AppTest</span> {\n\n  <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-smi\">Foo</span> {\n    <span class=\"pl-smi\">void</span> <span class=\"pl-en\">foo</span>() {}\n  }\n\n  <span class=\"pl-c1\">@</span><span class=\"pl-c1\">Test</span>\n  <span class=\"pl-k\">public</span> <span class=\"pl-smi\">void</span> <span class=\"pl-en\">test</span>() {\n    <span class=\"pl-smi\">Foo</span> <span class=\"pl-s1\">mock1</span> = <span class=\"pl-en\">spy</span>(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">Foo</span>());\n    <span class=\"pl-smi\">Foo</span> <span class=\"pl-s1\">mock2</span> = <span class=\"pl-en\">spy</span>(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">Foo</span>());\n    <span class=\"pl-s1\">mock1</span>.<span class=\"pl-en\">foo</span>();\n    <span class=\"pl-smi\">InOrder</span> <span class=\"pl-s1\">order</span> = <span class=\"pl-en\">inOrder</span>(<span class=\"pl-s1\">mock1</span>, <span class=\"pl-s1\">mock2</span>);\n    <span class=\"pl-s1\">order</span>.<span class=\"pl-en\">verify</span>(<span class=\"pl-s1\">mock1</span>).<span class=\"pl-en\">foo</span>();\n    <span class=\"pl-s1\">order</span>.<span class=\"pl-en\">verifyNoMoreInteractions</span>();\n  }\n}</pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"No interactions wanted here:\n-> at com.test.AppTest.test(AppTest.java:22)\nBut found this interaction on mock 'foo':\n-> at java.base/java.util.LinkedList.indexOf(LinkedList.java:609)\n\tat com.test.AppTest.test(AppTest.java:22)\"><pre class=\"notranslate\"><code>No interactions wanted here:\n-> at com.test.AppTest.test(AppTest.java:22)\nBut found this interaction on mock 'foo':\n-> at java.base/java.util.LinkedList.indexOf(LinkedList.java:609)\n\tat com.test.AppTest.test(AppTest.java:22)\n</code></pre></div>",
  "description_text": "The following test starts failing after 123beb8. It looks like the change to call actual equals and hashCode methods is catching a call to equals inside the implementation of InOrder.\npackage com.test;\n\nimport static org.mockito.Mockito.inOrder;\nimport static org.mockito.Mockito.spy;\n\nimport org.junit.Test;\nimport org.mockito.InOrder;\n\npublic class AppTest {\n\n  static class Foo {\n    void foo() {}\n  }\n\n  @Test\n  public void test() {\n    Foo mock1 = spy(new Foo());\n    Foo mock2 = spy(new Foo());\n    mock1.foo();\n    InOrder order = inOrder(mock1, mock2);\n    order.verify(mock1).foo();\n    order.verifyNoMoreInteractions();\n  }\n}\nNo interactions wanted here:\n-> at com.test.AppTest.test(AppTest.java:22)\nBut found this interaction on mock 'foo':\n-> at java.base/java.util.LinkedList.indexOf(LinkedList.java:609)\n\tat com.test.AppTest.test(AppTest.java:22)\n"
}