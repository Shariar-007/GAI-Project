{
  "issue_id": 1647,
  "issue_url": "https://github.com/jhy/jsoup/issues/1647",
  "title": "Allow attributes valid in html when converting from JSoup to W3C Document",
  "description": "<p dir=\"auto\">Consider the following html document:</p>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"<!DOCTYPE html>\n<html>\n<head></head>\n<body style=\"color: red\" \" name\">\n  <p h\u00e0nh=\"1\" h\u00ecnh=\"2\">unicode attr names</p>\n</body></html>\"><pre><span class=\"pl-c1\"><!DOCTYPE html<span class=\"pl-kos\">></span></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">html</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">head</span><span class=\"pl-kos\">></span><span class=\"pl-kos\"></</span><span class=\"pl-ent\">head</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">body</span> <span class=\"pl-c1\">style</span>=\"<span class=\"pl-s\">color: red</span>\" \" name\"<span class=\"pl-kos\">></span>\n  <span class=\"pl-kos\"><</span><span class=\"pl-ent\">p</span> <span class=\"pl-c1\">h\u00e0nh</span>=\"<span class=\"pl-s\">1</span>\" <span class=\"pl-c1\">h\u00ecnh</span>=\"<span class=\"pl-s\">2</span>\"<span class=\"pl-kos\">></span>unicode attr names<span class=\"pl-kos\"></</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"></</span><span class=\"pl-ent\">body</span><span class=\"pl-kos\">></span><span class=\"pl-kos\"></</span><span class=\"pl-ent\">html</span><span class=\"pl-kos\">></span></pre></div>\n<p dir=\"auto\">Using v1.14.2 and running the following code:</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"    public static void main(String[] args) {\n        String html = \"<!DOCTYPE html><html><head></head><body style=\\\"color: red\\\" \\\" name\\\"><p h\u00e0nh=\\\"1\\\" h\u00ecnh=\\\"2\\\">unicode attr names</p></body></html>\";\n        org.jsoup.nodes.Document jsoupDoc;\n        jsoupDoc = Jsoup.parse(html);\n        Document w3Doc = W3CDom.convert(jsoupDoc);\n        System.out.println(W3CDom.asString(w3Doc, W3CDom.OutputHtml()));\n    }\"><pre>    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">void</span> <span class=\"pl-s1\">main</span>(<span class=\"pl-smi\">String</span>[] <span class=\"pl-s1\">args</span>) {\n        <span class=\"pl-smi\">String</span> <span class=\"pl-s1\">html</span> = <span class=\"pl-s\">\"<!DOCTYPE html><html><head></head><body style=\\\"color: red\\\" \\\" name\\\"><p h\u00e0nh=\\\"1\\\" h\u00ecnh=\\\"2\\\">unicode attr names</p></body></html>\"</span>;\n        <span class=\"pl-smi\">org</span>.<span class=\"pl-smi\">jsoup</span>.<span class=\"pl-smi\">nodes</span>.<span class=\"pl-smi\">Document</span> <span class=\"pl-s1\">jsoupDoc</span>;\n        <span class=\"pl-s1\">jsoupDoc</span> = <span class=\"pl-s1\">Jsoup</span>.<span class=\"pl-en\">parse</span>(<span class=\"pl-s1\">html</span>);\n        <span class=\"pl-smi\">Document</span> <span class=\"pl-s1\">w3Doc</span> = <span class=\"pl-s1\">W3CDom</span>.<span class=\"pl-en\">convert</span>(<span class=\"pl-s1\">jsoupDoc</span>);\n        <span class=\"pl-smi\">System</span>.<span class=\"pl-s1\">out</span>.<span class=\"pl-en\">println</span>(<span class=\"pl-s1\">W3CDom</span>.<span class=\"pl-en\">asString</span>(<span class=\"pl-s1\">w3Doc</span>, <span class=\"pl-s1\">W3CDom</span>.<span class=\"pl-en\">OutputHtml</span>()));\n    }</pre></div>\n<p dir=\"auto\">Results in:</p>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"<!DOCTYPE html SYSTEM \"about:legacy-compat\">\n<html>\n<head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head>\n<body name=\"\" style=\"color: red\">\n  <p hnh=\"2\">unicode attr names</p>\n</body>\n</html>\"><pre><span class=\"pl-c1\"><!DOCTYPE html SYSTEM \"about:legacy-compat\"<span class=\"pl-kos\">></span></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">html</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">head</span><span class=\"pl-kos\">></span><span class=\"pl-kos\"><</span><span class=\"pl-ent\">META</span> <span class=\"pl-c1\">http-equiv</span>=\"<span class=\"pl-s\">Content-Type</span>\" <span class=\"pl-c1\">content</span>=\"<span class=\"pl-s\">text/html; charset=UTF-8</span>\"<span class=\"pl-kos\">></span><span class=\"pl-kos\"></</span><span class=\"pl-ent\">head</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"><</span><span class=\"pl-ent\">body</span> <span class=\"pl-c1\">name</span>=\"\" <span class=\"pl-c1\">style</span>=\"<span class=\"pl-s\">color: red</span>\"<span class=\"pl-kos\">></span>\n  <span class=\"pl-kos\"><</span><span class=\"pl-ent\">p</span> <span class=\"pl-c1\">hnh</span>=\"<span class=\"pl-s\">2</span>\"<span class=\"pl-kos\">></span>unicode attr names<span class=\"pl-kos\"></</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"></</span><span class=\"pl-ent\">body</span><span class=\"pl-kos\">></span>\n<span class=\"pl-kos\"></</span><span class=\"pl-ent\">html</span><span class=\"pl-kos\">></span></pre></div>\n<p dir=\"auto\">This is caused by <a href=\"https://github.com/jhy/jsoup/blob/master/src/main/java/org/jsoup/helper/W3CDom.java#L346\">W3CDOM.java#L346</a> hard-codes the syntax to <code class=\"notranslate\">xml</code>. It can be easily fixed by checking the doctype of the output document and use that as the syntax.</p>",
  "description_text": "Consider the following html document:\n\nunicode attr names\n\">>\n<html>\n<head>head>\n<body style=\"color: red\" \" name\">\n  <p h\u00e0nh=\"1\" h\u00ecnh=\"2\">unicode attr namesp>\nbody>html>\nUsing v1.14.2 and running the following code:\nunicode attr names\";\n        org.jsoup.nodes.Document jsoupDoc;\n        jsoupDoc = Jsoup.parse(html);\n        Document w3Doc = W3CDom.convert(jsoupDoc);\n        System.out.println(W3CDom.asString(w3Doc, W3CDom.OutputHtml()));\n    }\">    public static void main(String[] args) {\n        String html = \"unicode attr names\";\n        org.jsoup.nodes.Document jsoupDoc;\n        jsoupDoc = Jsoup.parse(html);\n        Document w3Doc = W3CDom.convert(jsoupDoc);\n        System.out.println(W3CDom.asString(w3Doc, W3CDom.OutputHtml()));\n    }\nResults in:\n\n\n\n\nunicode attr names\n\n\">>\n<html>\n<head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">head>\n<body name=\"\" style=\"color: red\">\n  <p hnh=\"2\">unicode attr namesp>\nbody>\nhtml>\nThis is caused by W3CDOM.java#L346 hard-codes the syntax to xml. It can be easily fixed by checking the doctype of the output document and use that as the syntax."
}